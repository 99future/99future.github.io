# Brant-X: A Unified Physiological Signal Alignment Framework

**Brant-X:一个统一的生理信号定位框架**

![image-20240816103330817](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816103330817.png)

---

## 摘要

生理信号是了解人体各种生理状态不可或缺的线索。大多数现有的工作都集中在单一类型的生理信号的一系列应用场景。然而，由于人体是一个整体的生物系统，各种生理数据之间的内在联系不容忽视。特别是，考虑到大脑作为生命活动的控制中心的作用，脑电图(EEG)与其他生理信号表现出显著的相关性。因此，**脑电图与其他生理信号之间的相关性**具有在各种情况下提高表现的潜力。

然而，实现这一目标仍然受到以下几个挑战的制约：**同时收集的生理数据的稀缺性，各种信号之间的相关性差异，以及各种任务之间的相关性差异**。

为了解决这些问题，我们提出了一个统一的**生理信号对齐框架**，Brant-X，来模拟脑电图和其他信号之间的相关性。我们的方法(1)采用脑电基础模型，将丰富的脑电知识数据高效地转移到其他生理信号中；(2)引入两级对齐，使脑电与不同语义尺度的其他信号的语义完全对齐。

在实验中，在不同场景下的各种下游任务上，包括睡眠阶段分类、情绪识别、步态冻结检测和眼动交流，Brant-X的表现与任务不可知基线和任务特定基线相比达到了最先进的水平。此外，对心律失常检测任务的分析和案例可视化进一步说明了Brant-X在脑电知识向其他生理信号转移方面的有效性。

**分类：**Applied computing → Health care information systems.

**关键词：**生理信号，多通道时间序列，对比学习，对齐，医疗保健

---

## 1 引言

生理信号作为不可或缺的生物标志物，表征了人体潜在的复杂性，包含了关于个体健康的广泛关键信息，对健康监测、疾病诊断和治疗具有重要意义[22,42]。其中，包括脑电图(EEG)、眼电图(EOG)、心电图(ECG)和肌电图(EMG)在内的几个关键信号在捕捉主要生理表现时尤为重要[49]。例如，记录大脑神经活动的脑电图信号已被用于研究睡眠和人类情绪的不同阶段，有助于诊断睡眠相关障碍和情绪健康问题[47]。此外，由于能够监测眼球运动过程中的潜在变化，EOG信号已被证明有助于神经退行性疾病患者的沟通[10,59]。此外，记录心脏生物电活动波动的ECG信号已被广泛应用于与心脏健康和疾病相关的研究中[66]。最后，肌电图信号捕捉人体肌肉的电活动，有助于神经肌肉疾病的诊断和康复训练[2]。这些生理信号的应用使临床医生能够实时监测个人健康状况，并做出数据驱动的决策，这对医疗保健等许多研究领域具有深远的影响。

尽管每一个生理信号都记录了相应身体部位的生理状况，但值得注意的是，身体是一个完整的生物系统，而不是一些独立的组成部分[68]。因此，不同的生理信号之间存在着内在的联系。其中，由于大脑是控制生命活动的中心，脑电图与来自其他身体部位的同步生理信号具有显著的相关性[29]。具体来说，在某些情况下，由于单类信号的信息可能不足或有噪声，忽略这种相关性会导致很大的性能损失。以睡眠阶段为例，如图1(a)所示，虽然EEG在不同阶段记录的脑电波不同，但EOG的快速振荡是快速眼动(REM)阶段尤为重要的标准。此外，Sharma等人[51]也表明，引入EOG信号可以使准确率相对提高14.98%。此外，脑电图与其他信号的相关性也存在于其他场景中:(1)**EEG&EOG**:对于只能通过眼动表达思想和实现互动的神经退行性疾病患者，EEG和EOG可以促进辅助沟通系统的发展[59]。(2)**脑电图和心电图**:在图1(b)的不同情绪状态下，脑信号和心跳始终呈现不同的模式，因此可以利用脑电图和心电图进行情绪识别[20]。(3)**脑电图和肌电图**:由于帕金森病的突发性肌肉僵硬(称为步态冻结，FoG)与运动、认知和情感因素的复杂相互作用有关，脑电图和肌电图可用于FoG检测，以提高患者的安全性和生活质量[74]。因此，EEG与其他生理信号(**本文中称为“EXG”，包括EOG、ECG和EMG**)之间的相关性具有在各种场景中提高性能的潜力。因此，我们的工作重点是建立一个以EEG为中心的EEG和EXG关联建模的统一框架，利用EEG和EXG的组合信息，为各种应用场景做出贡献。然而，目前的研究在这一方向上还有很多有待探索的地方，主要是由于以下挑战。

> ![image-20240816141023962](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141023962.png)
>
> 图1：脑电图与其他生理信号的内在相关性示意图。(a)不同睡眠阶段脑电图和眼电信号波形模式不同，尤其是在REM阶段，眼电信号振荡迅速。(b)心电兴奋增强心跳，脑电图中有明显的增强的时延波。悲伤会减慢心率，增加低频的大脑活动。放松时，心电表现为心率稳定，高频脑电图中波增高。

从数据的角度看，**同时采集的EEG信号和EXG存在明显的数据缺失**。由于获取成本、伦理限制以及当前机器学习研究中缺乏对信号相关性的重视，大多数生理数据只记录了单一类型的信号，例如数tb大小的EEG数据集[19]。相比之下，现有的包含多种同时采集的生理数据的多类型生理数据集规模要小得多，大多数小于几gb。因此，同时采集的EEG和EXG数据的稀缺性给训练统一的EEG和EXG相关性建模框架带来了挑战。


从方法角度看，**EEG与不同EXG信号的相关性存在显著的内在差异**。不同类型的生理信号在其固有特性(如振幅和带宽)方面存在很大差异[58]。为了满足采样定理[50]，带宽的巨大差距进一步导致了**采样率的差异**。具体来说，由于带宽的差距，EOG、ECG和EMG的采样率可能分别在50-100Hz、250-500Hz和1000-2000Hz的范围内变化。这些差异在其他特征上也很明显，如**典型波形和节律**[58]。上述因素导致EEG与不同exg之间的相关性存在巨大的内在差异，对EEG- exg相关性的统一建模方法提出了挑战。


从任务的角度来看，**在不同的场景下，不同的下游任务依赖于不同的关联，即使是在同一个EEG和EXG之间**。由于不同的应用场景涉及不同的身体器官生理活动，不同的下游任务需要捕获不同的EEG甚至相同的EEG之间的相关性。具体来说，由于睡眠期间的生理变化相对缓慢，在睡眠分期任务中，需要捕捉到30秒的EEG-EOG相关性，将其定义为一个睡眠阶段[7]。相比之下，在眼动交流任务中，眼球运动可能在不到1秒的时间内发生，这取决于不同的睡眠阶段的EEG-EOG相关性[24]。因此，捕捉不同下游情景的不同EEG-EXG相关性是具有挑战性的。


为了解决上述问题，我们提出了一个基于对比学习的框架Brant-X，以有效地**对齐来自不同语义尺度的EEG和EXG信号**，用于EEG和EXG之间的相关性建模。为了解决同时采集EEG和EXG数据的稀缺性，我们的直观想法是使用大量EEG数据训练的模型来增强对EXG信号的表示学习。受到在计算机视觉等其他研究领域广泛应用的大型语言模型的启发[39,63]，我们采用脑电信号基础模型Brant-2[70, 73]，该模型在4TB脑信号数据上进行预训练，包含1B个参数。在此基础上，我们总结了现有公开的多类型生理数据集，以实现从EEG到EXG的数据高效知识转移。观察到任务之间的差距主要源于语义相关尺度的差异，为了解决各种**信号和任务之间的差距，我们引入了两级对齐**，在patch级和序列级对齐EEG和EXG的语义。patch级比对克服了更细微的内在差异，并在更小的语义尺度上捕获EEG-EXG相关性，而序列级比对则在更大的语义尺度上对齐更粗的差异并捕获相关性。此外，我们采用了采样扩充来增强模型对不同采样率的鲁棒性。利用上述方法，扩展了脑电图中的数据和模型资源，为其他生理信号的研究赋予了权力，为各种生理信号之间的相关性建模开辟了新的途径。

为了验证Brant-X的有效性，大量实验表明，Brant-X在涉及EEG和EXG信号的不同场景下的各种下游任务上实现了SOTA性能，包括**睡眠阶段分类、情绪识别、步态冻结检测、眼动通信**。通过对案例1中心律失常检测任务的分析和可视化研究，进一步证明了Brant-X可以通过对齐有效地将EEG的知识转化为EXG信号。总体而言，我们的主要贡献包括:

- 我们第一个设计了一个统一的以脑电图为中心的校准框架，以模拟脑电图和其他生理信号之间的相关性，该框架可以应用于各种场景。
- 在EEG基础模型的基础上，采用两级对齐的数据高效知识传递方法，将EEG和EXG的语义结合起来，共同提高下游任务的性能。
- 我们通过涉及各种生理信号的多种下游任务的广泛实验验证了Brant-X。此外，分析和可视化表明了Brant-X在脑电知识向外神经网络知识转移中的有效性。

> ![image-20240816141158353](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141158353.png)
>
> 图2：生理信号定位框架Brant-X概述。首先，在EEG基础模型的基础上，通过同时采集的EEG数据与EXG数据的比对训练EXG编码器;然后，将能够从EEG和EXG信号中学习强表征的EEG和EXG编码器应用于不同场景下的各种下游任务。

---

## 2 方法

在本节中，我们将介绍拟议框架Brant-X的技术细节。具体而言，如图3左上部分所示，我们首先将EEG和EXG序列分割成连续的数据块。然后，考虑到不同场景下生理信号之间采样率的差异，我们采用采样增强(图3左下角)来增强模型对采样率变化的鲁棒性。如图3中间部分所示，将EEG patch和EXG patch以及增强后的patch分别送入EEG和EXG编码器，得到每个数据patch的表示。在这里，我们使用EEG基础模型Brant-2作为我们框架的EEG编码器(详见第2.2节)。在无监督训练过程中，我们提出了两级比对(图3的右部分)，在patch-level和sequence-level对同时采集的patch和序列进行比对。经过无监督对齐后，两个编码器输出的EEG和EXG数据的表示将通过不同场景下不同任务的注意机制进行聚合。

> ![image-20240816140928280](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816140928280.png)
>
> 图3：Brant-X的架构。在数据准备阶段，对EXG数据进行上采样和下采样以增强数据。然后，将EEG和EXG数据分别送入EEG编码器和EXG编码器，得到数据块的表示。最后，对同时采集到的EEG和EXG补丁以及相应的EEG和EXG序列进行二级比对。

### 2.1 问题表述


首先，我们形式化了进行实验的四个下游任务的定义。生理信号的收集依赖于信号收集垫，即电极，分布在被监测的身体部位。多个电极同时记录相应器官的生物电活动，产生多通道时间序列。形式上，给定 $𝑆$ EEG信号序列 $\{𝒙\}^{𝑆- 1}_{i=0}$，对应 $𝑆$ 生理过程，每个数据序列𝒙∈R𝐶×𝐿包括时间戳长度为𝐿的<s:1>通道。同时采集到的EXG信号，包括各扮成通道，记为{𝒙￣￣￣𝑆−1￣￣=0，其中𝒙￣￣∈R￣𝐶×𝐿。


根据不同的任务或场景，每一个多类型序列{𝒙，𝒙}都由专业医生用一个标签∈R进行标注。

基于以上，我们的研究问题可以定义为:定义2.1。给定EEG数据序列{𝒙至极部}𝑆−1至极部=0和EXG数据序列{𝒙￣至极部}𝑆−1至极部=0，并使用相应的标签{至极部}𝑆−1至极部=0，目的是对每个多类型序列{𝒙至极部}，𝒙￣至极部}进行分类，以确定其所属的类别。

### 2.2 EEG基础模型


由于同时采集的生理数据的稀缺性，建立一个统一的EEG和EXG相关性建模框架是一个挑战。为了解决这一问题，我们采用脑信号基础模型实现脑电信号到外脑电信号的高效数据知识转移。据我们所知，目前只有Brant系列作品作为大脑信号的开源基础模型，包括Brant和Brant-2。具体而言，Zhang等[73]提供了第一个现成的颅内脑电图(iEEG)2信号基础模型Brant，该模型包含了1.01TB iEEG数据预训练的500M个参数。Yuan等[70]在Brant的基础上提出了脑信号的基础模型Brant-2。它由超过1B个参数组成，并在多达4TB的混合数据上进行预训练(其中包括来自26名受试者的2.3TB iEEG数据和来自约15,000名受试者的1.6TB EEG数据)。我们选择使用Brant-2作为我们框架中的EEG编码器是双重的。首先，对大量脑信号数据进行预训练，可以从脑电信号中学习到强大的表征。更重要的是，它使用不同采样率的预训练数据，从而提高了对采样率变化的鲁棒性。

### 2.3 总体架构

**Patching**。由于生理数据是生物电信号，生理状态的语义信息只能通过多个采样点来集体表达，而不是单个采样点。因此，我们将整个数据序列拆分为几个连续的patch，以聚合patch内的语义信息，减少计算量[43]。

形式上,如左上角所示图3的一部分,鉴于𝑖-th多渠道脑电图数据序列𝒙𝑖∈R𝐶×𝐿𝐶表示脑电图通道的数量和𝐿表示数量的时间戳(序列)的长度,我们分裂𝒙与长度𝑀𝑖生成一组重叠补丁{𝒙𝑖,𝑗}𝑃−1𝑗= 0,在𝒙𝑖,𝑗∈R𝐶×𝑀𝑃=⌊𝐿/𝑀⌋是补丁的数量在这个序列。对于EXG数据，我们采用与上述相同的修补过程，符号也相似。具体来说，我们使用𝒙￣￣∈R￣𝐶×𝐿￣来表示𝑖-th EXG序列，其中，￣￣为EXG通道数，𝐿￣为序列长度。此外,{𝒙˜𝑖,𝑗}𝑃−1𝑗= 0表示补丁,在˜𝒙𝑖,𝑗∈R˜𝐶×𝑀。

**采样增强**。考虑到不同的生理信号在采样率上表现出很大的差异，从生理数据中学习表征的模型必须对采样率的变化具有足够的鲁棒性。对于EEG，如第2.2节所述，Brant-2在各种采样率下使用预训练数据，使其对采样率的变化具有相当的鲁棒性。因此，作为我们框架的脑电信号编码器，它能够处理脑电信号采样率的差异。


对于EXG信号，为了解决采样率不同的问题，我们采用了采样增强的方法来增强模型对采样率变化的鲁棒性。具体来说，如图3左下角所示，我们将原始数据上采样到原始速率的两倍，下采样到原始速率的一半，产生两组不同采样速率的增强数据。正式,因为原始EXG数据补丁{𝒙˜𝑖,𝑗}𝑃−1𝑗= 0,我们upsample数据采样率的两倍,生成upsampled数据补丁{𝒙˜”𝑖,𝑗}𝑃−1𝑗= 0,𝒙˜”𝑖,𝑗∈R˜𝐶𝑀×2。同样，将原始patch下采样到采样率的一半，得到下采样后的数据patch{𝒙￣“，𝑗}< <𝑗=0，其中𝒙￣“，𝑗∈R￣𝐶×⌊𝑀/2⌋。


在随后的表示学习和语义对齐部分中，原始数据𝒙≈以及上采样数据𝒙≈'和下采样数据𝒙≈'将被馈送到EXG编码器中，用于模型学习目的。

**嵌入到潜在空间**。对于EEG数据，如图3中间部分所示，我们将其直接输入到预训练的EEG编码器中(详见2.2节)，以获得EEG表示。形式上,连续𝑃补丁{𝒙𝑖,𝑗}𝑃−1𝑗= 0的𝑖-th脑电图数据序列𝒙𝑖EEG编码器的输入,产生表示{𝒑𝑖,𝑗}𝑃−1𝑗= 0的补丁,在𝒑𝑖,𝑗∈R𝐷𝑝𝑗-th补丁的表示表示𝑖-th序列的脑电图数据,和𝐷𝑝表示补丁的维数表示。


当涉及到EXG数据时，它将被输入到EXG编码器中以获得其表示。正式,所有补丁{𝒙˜𝑖,𝑗}𝑃−1𝑗= 0的𝑖-th EXG数据序列𝒙˜𝑖EXG编码器输入,生成他们表示{𝒑˜𝑖,𝑗}𝑃−1𝑗= 0,在𝒑˜𝑖,𝑗∈R𝐷𝑝。考虑到我们工作的重点是对齐框架，EXG编码器的特定架构可以是灵活的。本文使用的EXG编码器的技术细节请参考App. A。


同样,upsampled EXG补丁{𝒙˜”𝑖,𝑗}𝑃−1𝑗= 0和downsampled补丁{𝒙˜”𝑖,𝑗}𝑃−1𝑗= 0经历相同的过程,获得表征{𝒑˜”𝑖,𝑗}𝑃−1𝑗= 0和{𝒑˜”𝑖,𝑗}𝑃−1𝑗= 0的增强EXG数据。

### 2.4 两阶段对齐

为了克服EEG和EXG信号在不同语义尺度上的内在差异，捕捉EEG和EXG信号在不同语义尺度上的相关性，我们采用了在补丁级和序列级完全对齐EEG和EXG信号语义的两级对齐方法。

缀块对齐。在更精细的层面上，我们通过将同时存在的EEG和EXG补丁在潜在空间中紧密地放在一起，而将不相关的补丁进一步分开，在补丁级对齐EEG和EXG数据。如图3右上部分所示，由于我们的EEG编码器是在大量数据上进行预训练的(第2.2节)，因此有理由相信它可以输出EEG patch的代表性表示。因此，我们将EEG表示𝒑，𝑗作为锚点。将锚定𝒑￣￣，𝑗和同时采集的EXG patch𝒑￣￣￣，𝑗作为正样本对。负样本从其他EXG数据序列的{𝒑￣𝑚}𝑚≠<e:1>中随机抽取。值得注意的是，与后面描述的序列级比对相反，我们不能从EXG序列𝒑￣￣中随机选择{𝒑￣￣，𝑛}𝑛≠𝑗表示为负样本。这是因为这些表征{𝒑￣￣，𝑛}𝑛≠𝑗和锚源于相同的生理过程，并且它们之间可能具有时间依赖性。正式,锚𝒑𝑖𝑗,负样本集𝑍𝑝𝑖,𝑗是随机抽样的负样本{𝒑˜𝑚,𝑛|𝑚≠𝑖,𝑛= 0,…， < 0.01}。InfoNCE[44]损失用于保留正对之间的最大互信息:

<img src="http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141426922.png" alt="image-20240816141426922" style="zoom: 67%;" />

其中𝑡𝑝为调整尺度的温度超参数，L𝑝为在补丁级对齐中EEG与原始EXG数据之间的InfoNCE损失。

同样，在EEG数据和两组增强的EXG数据之间也存在相同的对齐过程。这两个损失分别记为L '𝑝和L '𝑝。总体而言，斑块级对齐的优化目标为:

<img src="http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141414400.png" alt="image-20240816141414400" style="zoom: 67%;" />

Sequence-level对齐。在更粗的粒度级别上，我们使用序列级对齐来对齐潜在空间中的相应序列。为了聚合数据序列中patch的表示，我们首先对序列𝒙序列中所有的patch表示𝒑，:∈R𝑃×𝐷𝑝进行线性投影𝑊𝑝𝑟𝑜𝑗∈R𝐷𝑠× R𝐷𝑝，得到序列表示<s:2>∈R𝐷𝑠，其中𝐷𝑠表示序列表示的维数:

<img src="http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141402113.png" alt="image-20240816141402113" style="zoom:67%;" />

这种线性投影类似地应用于EXG数据𝒑~，:和增强数据𝒑~，:，𝒑~，:，分别产生序列表示<s:2>，，和”。

在获得序列表示后，我们将同时采集到的EEG和EXG序列(<s:2>和)的表示设置为正样本对，其他所有序列对设置为负样本对。形式上，从所有负样本{<s:2>𝑚|𝑚≠}中随机抽取序列<e:1>的负样本集𝑍𝑠。EEG和原始EXG数据的序列级InfoNCE损失L𝑠可以给出如下:

<img src="http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141349402.png" alt="image-20240816141349402" style="zoom:67%;" />

其中𝑡𝑠表示温度超参数。如图3右下部分所示，我们按照CLIP[48]的惯例，采用相似度矩阵对该目标进行优化。


同样，我们在EEG和增强的EXG数据之间进行相同的对齐过程，导致相同形式的两个损失L '𝑠和L '𝑠。序列级比对的总体损失是:

<img src="http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816141333488.png" alt="image-20240816141333488" style="zoom:67%;" />


最后，通过添加补丁级和序列级比对损失L∗𝑝和L∗𝑠，得到联合优化的目标。

---

## 3 实验

### 3.1 实验设置

**对齐。**为了对同时记录的EEG和任意EXG数据进行对齐，用于无监督对齐的训练数据从三个数据集(**CAP[57]、ISRUC[32]和HMC[4]**)中集合，包括**EEG、EOG、ECG和EMG**信号。总体而言，校准训练数据包括来自**267名受试者的359条记录**。校准是在具有2个cpu (AMD EPYC9654 96核处理器)和2个gpu (NVIDIA Tesla A100 80G)的Linux系统上执行的。EEG编码器的学习率设置为1×10^−5^进行微调，而EXG编码器的学习率更高，为3 ×10^−4^。

**下游任务。**在这里，我们将介绍用于验证我们的Brant-X有效性的四个下游任务，以及数据集、设置和评估指标。

- **睡眠阶段分类。**在睡眠健康研究中，睡眠分期细化了人类对睡眠状态和模式的认识，对睡眠相关疾病的预防和诊断具有重要意义[47]。根据美国睡眠医学会(American Academy of Sleep Medicine, AASM)手册[7]，睡眠分为五个阶段:wake, N1, N2, N3, REM，其中N1至N3为非快速眼动睡眠，每个阶段逐渐进入深度睡眠。因此，睡眠阶段分类是一个五类分类问题。
  在数据集方面，**Sleep-EDF**数据集[31]在睡眠分期研究中非常流行。sleep - edf -78数据集包含来自睡眠磁带研究的153个通宵多导睡眠记录，包含来自78名年龄在25-101岁的受试者(37名男性和41名女性)的100Hz EEG和EOG数据。数据被分割成30秒的周期，并由专家手工注释。我们的研究也使用了Sleep-EDF-20数据集，该数据集包含来自20名受试者的39条记录，以便与现有方法进行比较。
  实验是在独立于受试者的环境下对**EEG和EOG信号**进行的。我们将受试者**按3:1:1的比例分为训练集、验证集和测试集**。在所有受试者身上重复实验以获得总体结果。评估指标包括准确性、敏感性、特异性、宏观F1评分和Cohen 's kappa 𝜅。

  > Bob Kemp, Aeilko H Zwinderman, Bert Tuk, Hilbert AC Kamphuisen, and Josefien JL Oberye. 2000. Analysis of a sleep-dependent neuronal feedback loop: the slow-wave microcontinuity of the EEG. IEEE Transactions on Biomedical Engineering 47, 9 (2000), 1185–1194.

- **情绪识别。**自动情绪识别在生物医学、脑机接口、智能环境、安全驾驶等领域取得了令人瞩目的进展[28]。情绪分为两类:(1)离散的情绪，如喜悦、恐惧和悲伤;(2)多维情绪:唤醒、效价和支配三个维度。现有工作[30,35,36,54,56]主要关注多维情绪的识别，因此该任务可视为三个独立的二元分类问题:低/高效价、低/高唤醒和低/高支配。
  使用**Dreamer**数据集[30]进行情绪识别任务的实验。它包含23名受试者(14男9女)在观看18个电影片段时的脑电图(128Hz)和心电图(256Hz)数据。每部电影的平均长度为90秒，这被认为足以引发一种情感。在观看完电影片段后，情绪状态在三个情绪维度上被标记为低或高，作为情绪识别的标签。
  本任务中的实验是在独立于受试者的情况下对**EEG和ECG信号**进行的。我们将受试者**按3:1:1的比例分成训练组、验证组和测试组**，并对所有受试者重复实验。评价指标主要是准确率[35,36,56]，也有一些研究[30,54]包括F1分和准确率-召回率曲线的AUC。

  > Stamos Katsigiannis and Naeem Ramzan. 2017. DREAMER: A database for emotion recognition through EEG and ECG signals from wireless low-cost offthe-shelf devices. IEEE journal of biomedical and health informatics 22, 1 (2017), 98–107.

- **步态检测冻结。**FoG是指由于大脑不能处理并发的认知和运动要求而导致的运动中断，是影响约50%-80%帕金森病患者的最严重的表现之一。因此，准确检测FoG可以显著提高患者的生活质量，促进个性化治疗[74]。FoG检测任务是一个二元分类问题，即判断行走过程中是否出现FoG。
  本研究使用FoG数据集[74]，包括12例帕金森病患者(6男6女)的脑电图和肌电图信号(1000Hz)，患者年龄在57-81岁，病程在1 - 20年之间。有效数据持续3h42min，包括正常步态2h14min和步态冻结1h28min，由两名有资质的医师标注。
  本课题的实验是在**EEG和EMG**上进行的。训练、验证和测试数据**按3:1:1的比例随机分割**。我们还重复实验以获得总体结果。作为一个分类问题，用于该任务的评估指标是准确率、精度、召回率和F1分数。

  > Wei Zhang, Zhuokun Yang, Hantao Li, Debin Huang, Lipeng Wang, Yanzhao Wei, Lei Zhang, Lin Ma, Huanhuan Feng, Jing Pan, et al. 2022. Multimodal data for the detection of freezing of gait in Parkinson’s disease. Scientific data 9, 1 (2022), 606.

- **眼球运动交流。**由于肌萎缩性侧索硬化症(ALS)等神经退行性疾病导致的瘫痪，许多患者几乎失去了所有的交流能力[24]，只有残余的动眼肌控制能力来使用拼写系统组成单词、短语和句子[59]。该拼写系统采用二元原则，即患者通过移动眼睛来回答听觉问题，表示“是”，而不移动眼睛表示“否”。因此，眼动沟通任务也是一个二元分类问题(是或否)。
  眼动交流实验使用**Jaramillo-Gonzalez等[24]**发表的数据集。该数据集包含4名ALS患者的EEG和EOG数据(500Hz)。在2-10次访问期间记录数据，每次访问平均为3.22天，每天记录5.57次。由于数据集中不同文件的EOG通道不一致，我们排除了缺乏特定EOG通道的文件进行实验。
  本实验采用**EEG和EOG相结合**的方法进行。**训练、验证和测试数据按8:1:1分割**进行实验，并在所有数据文件上重复。评价指标为准确率、精密度、召回率和F1分。
  在数据预处理方面，除了眼动分类之外的三个任务，我们没有进行过滤和其他处理，直接使用原始数据集的预处理数据。对于眼动数据集，由于发布者没有过滤，我们应用了45Hz低通过滤和z-score归一化。

  > Andres Jaramillo-Gonzalez, Shizhe Wu, Alessandro Tonin, Aygul Rana, Majid Khalili Ardali, Niels Birbaumer, and Ujwal Chaudhary. 2021. A dataset of EEG and EOG from an auditory EOG-based communication system for patients in locked-in state. Scientific data 8, 1 (2021), 8.

**基线。**作为生理信号建模的统一无监督对齐框架，我们将Brant-X与针对一般时间序列设计的高级自监督或无监督方法在所有下游任务上进行了比较，包括**TF-C**[75]和**SimMTM**[15]。此外，为了将Brant-X与基于预训练语言模型进行时间序列分类的方法进行比较，我们将**OneFitsAll**[76]和**Time-LLM**[27]设置为基线。对于监督方法，由于其效率和通用性，我们选择**MiniRocket**[14]作为基准。此外，我们将Brant-X与专门为每个任务设计的SOTA方法进行了比较，以证明Brant-X在各种场景中的有效性。这些特定任务或特定信号的监督方法包括:(1)用于睡眠阶段分类的tinyssleepnet[55]、XSleepNet[45]、L-SeqSleepNet[46]、SleepHGNN[25]、SleepKD[34]和SleepDG [62];(2) MLF-CapsNet [36]， EEG-Conformer[52]，林等[35]， Wang等[64]进行情绪识别;(3) Aly and Youssef [5]， Batool and Javeed [6]， Goel等[17]冻结步态检测;(4) eye esay [77]， Adama and Bogdan [1]， Hossieny等[23]。有关这些基线的更多细节请参见应用程序B。

### 3.2 实验结果

图4总结了Brant-X和其他基线在各种下游任务(包括3.3节中的心律失常检测)上的总体准确性。由于特定于任务的方法在不同的任务中有所不同，我们使用“特定于任务的方法”来共同表示它们在每个任务上的最佳结果。如图4所示，与其他基准方法相比，brandt - x在所有五个任务上都达到了SOTA性能，说明了我们的框架在各种场景下的有效性。对每个任务的详细比较将在以下段落中讨论，在所有表格中，我们在每列中标记排名第一(v)、第二(v)和第三(v*)的值。

> ![image-20240816140830584](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816140830584.png)
>
> 图4：各种任务的总体性能比较。

睡眠阶段分类任务的性能对比见表1。结果表明，Brant-X在几乎所有的性能指标中都获得了最高的排名，说明Brant-X能够有效地将脑电信号中的知识转化为脑电信号，结合脑电信号和脑电信号的信息，学习到其中的高级语义信息。一般时间序列上的基线没有得到很好的结果，主要是因为这些模型难以克服各种生理信号之间内在特征的巨大差距，并且不像Brant-X那样对不同语义尺度的相关性进行建模。

> ![image-20240816143151675](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816143151675.png)

如表2所示，在情绪识别任务上，与所有基线相比，brent - x达到了SOTA性能。与单独为EEG设计的基线相比，Wang等[64]获得了第二名，因为它采用了与Brant-X相同的策略，将EEG和ECG的信息结合在一起，从而显示出更强的学习能力。然而，得益于基于对比学习的一致性训练，brandt - x在所有指标上仍然超过Wang等人[64]。

> ![image-20240816143230022](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816143230022.png)

步态检测和眼动交流任务冻结的总体结果分别见表3和表4。Brant-X在这两项任务上击败了所有的基线方法，显示出它能够从同时收集的EEG、EMG和EOG数据中学习表征。Batool等人[6]和Adama等人[1]分别在这两个任务上取得了第二好的性能，主要是因为他们明确地提取了生理信号的频域信息作为生理数据建模的固有特征。

> ![image-20240816143304720](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816143304720.png)

### 3.3 消融实验

为了评估Brant-X中各分量的有效性，我们对四种模型变体进行了消融实验，包括:(1)Brant-X w/o采样-aug:对准过程中没有采样增强的Brant-X;(2) Brant-X w/o patch-align:没有patch-level alignment的Brant-X;(3) Brant-X w/o seq-align:没有序列级比对的Brant-X;(4) Brant-X无脑电信号编码器:对准后下游评估时不带脑电信号编码器的Brant-X;(5) Brant-X无EXG编码器:对准后下游评估时不带EXG编码器的Brant-X。

四个下游任务的烧蚀实验对比结果如图5所示。它证明了brandt - x在所有任务的所有指标上都优于其他变体，证明了我们框架中每个组件的贡献。

> ![image-20240816140739361](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816140739361.png)
>
> 图5：所有下游任务的消融研究结果。


与全Brant-X相比，w/o采样-aug的Brant-X性能下降，表明采样增强提供了对可变采样率的模型鲁棒性增强。此外，Brant-X w/o patch-align和Brant-X w/o seq-align的性能也有所下降，这表明两级对齐可以将不同语义尺度的EEG和EXG信号对齐，从而从生理数据中学习信息表征。对于睡眠分期和情绪识别，由于脑电信号在这些场景中起着重要作用，因此Brant-X w/o脑电信号编码器的性能下降很大。正如我们在第1节所强调的，这证实了大脑在重要活动中作为中央控制的重要性。


编码器分析。作为烧烧实验中Brant-X w/o EEGencoder的补充，我们将评估扩展到使用独立的EXG编码器的更多任务，以验证EXG编码器是否可以在对准训练期间从EXG数据中学习有用的表示。具体而言，我们在心电数据上使用对齐的EXG编码器(未在EEG数据上合并EEG编码器)进行心律失常检测任务的实验。


关于这项任务的更多细节和结果在App. C中给出。


如表5所示，brandt - x在心律失常检测任务上达到了SOTA的性能，表明对齐训练确实能够使EXG编码器从心电信号中学习表征，从而有效地对心律进行分类。

### 3.4 案例研究

图6显示了两个多类型生理数据序列{𝒙￣，𝒙￣￣}和{𝒙𝑗，𝒙￣𝑗}的补丁表示之间的四个相似矩阵。纵轴表示𝒙￣￣和𝒙𝑗两个EEG序列的patch表示，横轴表示𝒙￣￣和𝒙￣𝑗两个EXG序列的patch表示。因此，图6给出了四个相似矩阵。每个小正方形的颜色越深，两个对应块表示之间的归一化相似性越高。

> ![image-20240816140636096](http://funera-hk.oss-cn-hongkong.aliyuncs.com/img/image-20240816140636096.png)
>
> 图6：patch表示的相似矩阵。纵轴表示𝒙__i和𝒙𝑗两个EEG序列的patch表示，横轴表示𝒙￣￣和𝒙￣𝑗两个EXG序列的patch表示。

其中，矩阵(a)(或(d))表示同时采集的EEG序列𝒙￣(或𝒙𝑗)和EXG序列𝒙￣￣(或𝒙￣𝑗)的patch表示的相似性。它呈现出整体较深的颜色，表明同时收集的EEG和EXG序列的斑块之间的相关性。此外，矩阵(a)(或(d))的对角线特别暗，表明**同时的EEG和EXG patch对齐良好**。然而，对于矩阵(b)和(c)，它们的整体颜色较浅，表明**非同时收集的EEG和EXG数据的斑块表示之间几乎没有相关性**。在这种情况下，这四个相似矩阵很好地说明了两级对齐可以使同时的EEG和EXG数据的表示更接近，同时距离不相关的序列，这样Brant-X可以执行从EEG到EXG的知识转移。

---

## 4 相关工作

**生理信号建模。**随着生理记录技术的成熟和机器学习方法的进步，生理信号建模受到了许多研究者的关注。最初，研究人员主要关注单一类型信号的模型学习。大量的研究工作提出使用时间序列[18,36,37,45,52,55,71]或图[8,12,35]数据结构与监督[18,35 - 37,45,52,55]或自监督[8,12,71]学习范式来处理脑电信号的各种任务。近年来，一些大型脑电模型也出现了[26,70,73]，突破了不同任务对脑电的限制。此外，还提出了基于特征工程或监督学习的方法，从EOG[1,23,77]、ECG[3,40]和EMG[41,72]信号中学习表征。此外，为了充分挖掘生理数据的潜在语义，多类型信号的建模已经引起了研究的关注。Jia等[25]考虑了EEG、EOG和EMG信号的交互性，提高了SOTA在睡眠分期任务中的表现。Wang等[64]融合单导联EEG和ECG数据的特征进行情绪识别。Aly和Youssef[5]提出了一种将EEG和EMG信号相结合的方法，提高了手腕部运动控制的性能。然而，大多数关于生理信号的研究都是针对特定任务或特定信号的。它们既没有利用基础模型(因此受到数据稀缺性的阻碍)，也没有为一系列任务中的各种生理信号提供统一的框架。

**多模态对齐。**为了利用多模态数据中的信息一致性，基于对比学习的对齐策略在imagetext等许多领域取得了令人印象深刻的成果[48,67,69]。对于生理学研究，方法[9,11]对图像特征进行对齐，用于医学图像分割。Wang等[61]将配对的医学图像和放射学报告(文本)进行对齐，用于图像分类和目标检测等。Fan等[16]提出了一种域自适应方法来弥补源域和目标域的脑电数据分布之间的差距，用于睡眠分期。Lv等人[38]通过调整视频片段中的视觉和声学模态来增强特征，以进行情感识别。然而，这些研究主要是探讨文本、图像或音频模式之间的一致性，这些模式都没有明确地将同时收集的生理信号对齐。

**时间序列建模。**时间序列(TS)分析已被广泛应用于金融、气象、医疗等领域，并吸引了越来越多的研究者。Wu等[65]提出将TimesNet作为任务通用主干，自适应地发现TS分析的多周期性。Dong等[15]提出通过对流形外的多个邻居进行加权聚集来恢复被掩盖的时间点，用于TS建模。Zhou等人[76]提出了一种利用语言或视觉模型进行TS分析的统一模型。Jin等人[27]提出了一个名为Time-LLM的重编程框架，将大型语言模型重新用于一般的TS预测。然而，大多数TS工作不能很好地适应高频生理信号，忽略了生理信号之间的相关性。

---

## 5 结论

在这项工作中，我们首次提出了一个统一的生理信号对齐框架，brent - x。在脑电基础模型的基础上，总结了现有的多类型生理数据集，将脑电基础模型中丰富的知识转化为EXG信号。我们采用两级对齐，在补丁级和序列级对齐EEG和EXG数据的语义，以适应各种下游场景。这样，EEG就可以作为EEG基础模型和EXG数据之间的桥梁，使EEG领域的数据和模型资源能够为其他生理信号的研究提供支持，为各种生理信号之间的相关性建模开辟了新的途径。未来，在Brant-X阳性结果的激励下，沿着这条研究路线探索更多生理信号的进一步研究将是有趣的。
